<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TF62H5X');</script>
  <!-- End Google Tag Manager -->
  <title>
  </title>

  <link rel="stylesheet" href="styles/this.css"/>

  <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">-->

  <!--<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
      integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
      crossorigin="anonymous"/> -->

  <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">-->

  <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->

  <!--<script>
    src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js">
  </script>-->

  <!-- <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script> -->
  <script type="application/javascript">

  'use strict'

  function getIP(json) {

    var fallback = 'Portland'
    var local_zips = {
      'Hermiston' : [
        97875,
        97838,
        99346
      ],
      'TheDalles' : [
        97058,
        97031,
        97040
      ]
    }

    function key_lookup_by_item_index(item, assoc_arr, fallback) {
      var result = fallback
      var keys = Object.keys(assoc_arr)
      keys.forEach( function (key) {
        if (assoc_arr[key].indexOf(item) > -1 ) {
          result = key
        }
      })
      return result
    }

    var branch = key_lookup_by_item_index(json.postal, local_zips, fallback)

    var my_api_says = {
      /*
      'ipEvent' : 'ipEvent',
       ipPostal : json.postal,
       ipCity : json.city,
       ipAddress : json.ip,
       */
    }

    dataLayer.push({swapTarget : branch})
    console.log(my_api_says)
  }

  getIP({
    postal : 97058,
    city: 'Spaghetti',
    ip : '55.55.555.555'
  })

  </script>

</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TF62H5X"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

</body>


<script src="lib/script1.js"></script>

</html>
